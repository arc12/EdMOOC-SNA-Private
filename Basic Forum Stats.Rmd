Basic Forum Stats
========================================================

```{r echo=FALSE, results='hide'}
courseIDs<-c("aiplan","astro","crit","equine")
echo.sql<-TRUE # echo SQL statements
echo.flag<-TRUE #echo R source
fig.width.default<-7
fig.height.default<-7
options(knitr.table.format = 'markdown')
read_chunk("./Basic Forum Stats.R")
```

```{r INIT, echo=FALSE}
#initialises the DB and sources helper.
```

Quantify users vs registrations.
```{r ACCESSED, echo=FALSE}
```
```{r echo=FALSE, results='asis'}
kable(accessed.df, row.names=T, align='c')
```

Proportion of show/no-show.
```{r echo=echo.flag, fig.width=fig.width.default, fig.height=fig.height.default}
accessed.proportions<-t(accessed.df$accessed/accessed.df$registered)
colnames(accessed.proportions)<-row.names(accessed.df)
barplot(rbind(accessed=accessed.proportions, no.show=1-accessed.proportions), main="Registrations with at Least 1 Access Event", ylab="Conversion Fraction")

```

Qty of forums, threads, posts, comments
-----------
```{r FORUM_COUNT, echo=FALSE}
```
### Forums

```{r echo=FALSE, results='asis'}
#curious align due to bug in knitr
kable(forumCount.df, row.names=T, align=rep("c", length(colnames(forumCount.df))))
```

### Threads

```{r echo=FALSE, results='asis'}
kable(threadCount.df, row.names=T, align=rep("c", length(colnames(threadCount.df))))
```

### Posts

```{r echo=FALSE, results='asis'}
kable(postCount.df, row.names=T, align=rep("c", length(colnames(postCount.df))))
```

### Comments

```{r echo=FALSE, results='asis'}
kable(commentCount.df, row.names=T, align=rep("c", length(colnames(commentCount.df))))
```


No of posters by role
-------------

```{r POSTER_ROLES, echo=FALSE}
```
```{r echo=FALSE, results='asis',}
kable(posterRoles.df, row.names=T, align=rep("c", length(colnames(posterRoles.df))))
```
*role names are assumed to be the same for the same id across courses*

Density comments on posts (etc), compare distributions
-----------

**At present these do not exclude deleted or spam**

### Bushiness Factors

Compute the degree - i.e. the average number of "child" entities per parent - to which forums, threads, post and comments branch.

```{r echo=FALSE, results='asis'}
kable(bushiness.df, row.names=T, align=rep("c", length(colnames(commentCount.df))))
```

### Distribution of Comments on Posts

```{r FORUM_DISTRIBUTION, echo=FALSE}
```

```{r echo=echo.flag, fig.width=fig.width.default, fig.height=fig.height.default}
barplot(100*post_0comments/postCount.df$posts, main="Proportion of posts with no comments", ylab="%")
```

What is the distribution of the number of posts with 1,2,... comments on them?

```{r echo=echo.flag, fig.width=fig.width.default, fig.height=fig.height.default}
# remove cases where comments>20 to simplify plotting
for(i in 1:length(post_commentDist2)){
   post_commentDist2a<-post_commentDist2[[i]][post_commentDist2[[i]]$comments<=20,"comments"]
   cut.posts<-length(post_commentDist2[[i]]$comments[post_commentDist2[[i]]$comments>20])
   hist(post_commentDist2a, main=names(post_commentDist2)[i], xlab="No. of Comments", ylab="No. of Posts", sub=paste(cut.posts,"posts with >20 comments"))
}
```



```{r echo=FALSE}
## ****************************************************
## Created: Adam Cooper, Cetis, Oct 2013
## This source code was produced for The University of
## Edinburgh DEI as part of their MOOC initiative.
## ****************************************************

## ***Made available using the The MIT License (MIT)***
#The MIT License (MIT)
#Copyright (c) 2013 Adam Cooper, University of Bolton
#
#Permission is hereby granted, free of charge, to any person obtaining a copy of
#this software and associated documentation files (the "Software"), to deal in
# the Software without restriction, including without limitation the rights to
# use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
# the Software, and to permit persons to whom the Software is furnished to do so,
# subject to the following conditions:
#    
#    The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
# FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
# COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
# IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
# CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
## ************ end licence ***************
```